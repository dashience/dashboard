<script>
    function get(name) {
        var dataSourceType = localStorage.getItem("dataSourceType 
        if (dataSourceType == "facebook" || dataSourceType == "linkedin")
        {
            if (name = (new RegExp('[?&#]' + encodeURIComponent(name) + '=([^&]*)')).exec(location.search))
                return decodeURIComponent(name[1]);
        }

        if (dataSourceType == "instagram")
        {
            var variable = "access_token";
            var query = window.location.href.substring(1);
            var vars = query.split('#');
            for (var i = 0; i < vars.length; i++) {
                var pair = vars[i].split('=');
                if (decodeURIComponent(pair[0]) == variable) {
                    return decodeURIComponent(pair[1]);
                }
            }
        }
    }
    window.opener.document.getElementById("fbAccessToken").value = get("code");
    window.close();
</script>
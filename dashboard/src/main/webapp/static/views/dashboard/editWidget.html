<style>
    .as-sortable-item, .as-sortable-placeholder {
        display: table-cell !important;
    }
    *.unselectable {
        -moz-user-select: -moz-none;
        -khtml-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }
    .close {
        float: right;
        font-size: 21px;
        font-weight: bold;
        line-height: 1;
        color: #000;
        text-shadow: 0 1px 0 #fff;
        filter: alpha(opacity=20);
        opacity: .2;
        margin-top: 0px;
        margin-right: 0px;
    }

    .preview-table-settings:hover .button{
        opacity: 1;
    }
    .ns-popover-tooltip > li {
        display:block;
        padding: 3px 20px;
        clear: both;
        font-weight: normal;
        line-height: 1.42857143;
        color: #333;
        white-space: nowrap;

    }

    .col-md-2{
        margin-top: 20px !important;
    }
    .checkbox{
        margin-top: 30px !important;
    }
    .controls {
        padding-bottom: 10px;
    }

    .ns-popover-tooltip a {
        text-decoration: none;
    }


    .scheduler-checkBox-label{
        display: block;
        padding-left: 15px;
        text-indent: -15px;
        cursor: pointer;
    }
    .scheduler-checkBox{
        width: 13px;
        height: 13px;
        padding: 0;
        margin:0;
        vertical-align: bottom;
        position: relative;
        top: -1px;
        *overflow: hidden;
    }
    .close {
        float: right;
        font-size: 21px;
        font-weight: bold;
        line-height: 1;
        color: #000;
        text-shadow: 0 1px 0 #fff;
        filter: alpha(opacity=20);
        opacity: .2;
        margin-top: 0px;
        margin-right: 0px;
    }
    .custom-daterange-box{
        display: flex;
        width: 100%;
        height: 34px;
        padding: 6px 12px;
        font-size: 14px;
        line-height: 1.42857143;
        color: #555;
        background-color: #fff;
        background-image: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
        box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
        -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
        -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
        transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
    }
    .custom-daterange-box-icon{
        margin-left: 48px;
    }
    .scheduler-list-style{
        height: auto;
        overflow: auto;
    }
    .ui-select-bootstrap > .ui-select-choices, .ui-select-bootstrap > .ui-select-no-choice {
        display: contents;
    }
    .search-check {
        vertical-align: middle;
    }
    .edit-widget {
        margin-top:10px;
        margin-bottom:10px;
    }
    .edit-widget-space{
        overflow: hidden;
    }
    .dragtable-sortable { 
        list-style-type: none; margin: 0; padding: 0; -moz-user-select: none;
    }
    .dragtable-sortable li {
        margin: 0; padding: 0; float: left; font-size: 1em; background: white; 
    }

    .dragtable-sortable th, .dragtable-sortable td{
        border-left: 0px;
    }

    .dragtable-sortable li:first-child th, .dragtable-sortable li:first-child td {
        border-left: 1px solid #CCC; 
    }

    .ui-sortable-helper {
        opacity: 0.7;filter: alpha(opacity=70);
    }
    .ui-sortable-placeholder { 
        -moz-box-shadow: 4px 5px 4px #C6C6C6 inset;
        -webkit-box-shadow: 4px 5px 4px #C6C6C6 inset;
        box-shadow: 4px 5px 4px #C6C6C6 inset;
        border-bottom: 1px solid #CCCCCC;
        border-top: 1px solid #CCCCCC;
        visibility: visible !important;
        background: #EFEFEF !important; 
        visibility: visible !important;
    }
    .ui-sortable-placeholder * { 
        opacity: 0.0; visibility: hidden; 
    }
    .builder, .builder:hover{
        background-color: #83a958;
        border-color: #83a958;
        color: #fff !important;
    }
    .builderAnd{
        color: #6a6c6f;
    }

</style>
<div class="normalheader transition animated fadeIn">
    <div class="hpanel">
        <div class="panel-body header-title">
            <div id="hbreadcrumb" class="pull-right">
            </div>
            <h2 class="font-bold m-b-xs ng-binding" translate>
                Edit Widget
            </h2>               
        </div>
    </div>
</div>
<div ng-show="loadingEditWidget" class="text-center"><img src="static/img/logos/loader.gif" width="100"></div>
<div class="content" ng-repeat="widget in editWidgetData">
    <div class="row edit-widget">
        <!---->
        <div class="pull-right" ng-if="loadColumnDef === false">
            <button class='btn btn-default' ng-click='closeWidget()'><span class='fa fa-times'></span> <span translate>Cancel</span></button>
        </div>
        <div class="row col-md-12">
            <div class="col-lg-4">
                <div>
                    <label translate>Data Source</label>
                    <div class="input-group m-b">
                        <span class="input-group-addon">
                            <div ng-if="permission.createDataSource === true;"> 
                                <i title="{{'Data Source'| translate}}" ng-click="removeBackDrop()" data-ui-sref="index.dataSource({accountId: accountId,accountName: accountName, startDate: startDate, endDate: endDate})" class="fa fa-link"></i>
                            </div>                            
                        </span>
                        <select class="form-control m-b" ng-model="widget.dataSourceId" ng-disabled="widget.chartType == 'text'"
                                ng-change="selectDataSource(widget.dataSourceId, widget)"
                                ng-options="dataSource.name for dataSource in dataSources track by dataSource.id">
                        </select>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div>
                    <label translate>Data Set</label>
                    <div class="input-group m-b">
                        <span class="input-group-addon">                                
                            <div ng-if="permission.createDataSet === true;">
                                <i title="{{'Data Set'| translate}}" ng-click="removeBackDrop()" data-ui-sref="index.dataSet({accountId: accountId,accountName: accountName, startDate: startDate, endDate: endDate})" class="fa fa-link"></i>
                            </div>
                        </span>
                        <select class="form-control" ng-disabled="widget.chartType == 'text'" ng-model="widget.dataSetId" ng-options="dataSet.name for dataSet in dataSets track by dataSet.id" ng-change="changeUrl(widget.dataSetId, widget)">
                        </select>
                    </div>
                </div>
            </div>
            <div ng-if="loadColumnDef === true" class="col-lg-4">
                <div ng-show="loading" class="col-md-12">
                    <div><label translate>Chart Type</label></div>
                    <a class="btn btn-app" ng-repeat="chartType in chartTypes track by chartType.id" ng-click="previewChart(chartType, widget)"> 
                        <span class="previewChart" title="{{chartType.name}}">
                            <i style="cursor: pointer" class="fa {{chartType.icon}}" ng-class="{'selected': chartType.type == (selectedRow?selectedRow:widget.chartType)}"></i> </span>
                    </a>
                </div>
            </div>
        </div>
        <div ng-if="loadColumnDef === true" class="row col-md-12">            
            <div ng-show="loading" ng-if="editChartType == 'table'">   
                <div class="form-group col-md-4">
                    <div>
                        <label translate>Max Record</label>
                        <input type="text" ng-model="widget.maxRecord" class="form-control">
                        <!--<input type="text" ng-model="widget.maxRecord" class="form-control" ng-change="reloadMaxRecord(widget)">-->
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="col-md-12">
                        <div class="checkbox col-md-6" >
                            <input type="checkbox" ng-model="widget.tableFooter" ng-checked="widget.tableFooter == 1" />
                            <label translate> Table Footer </label>
                        </div>

                        <div class="checkbox col-md-6" >
                            <input type="checkbox" ng-model="widget.zeroSuppression" ng-checked="widget.zeroSuppression == 1">
                            <label translate>Zero Suppression</label>
                        </div>
                    </div>
                </div> 
            </div>
        </div>
        <div class="text-center" ng-if="widget.dataSetId" ng-hide="loading"><img src="static/img/logos/loader.gif" width="40"></div>
        <div ng-if="loadColumnDef === true" class="row col-md-12">
            <div ng-show="loading">
                <div class="col-md-4">
                    <label translate>Date Range</label>
                    <div>
                        <div class="dropdown editWidgetDropDown">
                            <button class="drop btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" id="dateRangeName">
                                {{widget.dateRangeName?widget.dateRangeName:"Select Date Duration"}}
                                <span class="caret"></span></button>
                            <ul class="dropdown-menu scheduler-list-style">
                                <li>
                                    <div class="col-md-12">
                                        <div>
                                            <a class="pull-right custom-daterange-box" custom-Widget-Date-Range ng-click="selectDateRangeName(widget)" widget-Table-Date-Range="{{widget}}" id="widgetDateRange">
                                                <span class="date-border">
                                                    {{widget.customStartDate ? widget.customStartDate : startDate| date: "MM/dd/yyyy"}} - {{widget.customEndDate ? widget.customEndDate : endDate| date: "MM/dd/yyyy"}} 
                                                </span>
                                            </a> 
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <a><span translate>Last</span> <input type="text"
                                                   ng-model="widget.lastNdays" 
                                                   ng-change="selectWidgetDuration('Last N Days', widget)" 
                                                   class="form-control" 
                                                   ng-model-options="{debounce: 500}"
                                                   style="width: 60px; display: contents; height: 25px;"> 
                                        <span translate>Days</span>
                                    </a>
                                </li>
                                <li>
                                    <a><span translate>Last</span><input type="text" 
                                                   ng-model="widget.lastNweeks" 
                                                   ng-change="selectWidgetDuration('Last N Weeks', widget)"
                                                   class="form-control" 
                                                   ng-model-options="{debounce: 500}"
                                                   style="width: 60px; display: contents; height: 25px;"> 
                                        <span translate>Weeks</span>
                                    </a>
                                </li>
                                <li>
                                    <a><span translate>Last</span> <input type="text" 
                                                   ng-model="widget.lastNmonths" 
                                                   ng-change="selectWidgetDuration('Last N Months', widget)"
                                                   class="form-control" 
                                                   ng-model-options="{debounce: 500}"
                                                   style="width: 60px; display: contents; height: 25px;"> 
                                        <span translate>Months</span>
                                    </a>
                                </li>
                                <li>
                                    <a><span translate>Last</span> <input type="text" 
                                                   ng-model="widget.lastNyears" 
                                                   ng-change="selectWidgetDuration('Last N Years', widget)"
                                                   class="form-control" 
                                                   ng-model-options="{debounce: 500}"
                                                   style="width: 60px; display: contents; height: 25px;"> 
                                        <span translate>Years</span>
                                    </a>
                                </li>
                                <li><a class="col-md-12" ng-click="selectWidgetDuration('None', widget)" translate>None</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <label translate>Account</label>
                    <div>
                        <select class="form-control" ng-model="widget.accountId" ng-options="account.accountId.accountName for account in accounts track by account.id" ng-change="selectAccount(widget)"></select>
                    </div>
                </div> 
            </div>
        </div>
        <div ng-if="loadColumnDef === true">            
            <div ng-show="loading">
                <div class="nav-tabs-custom col-md-12">
                    <ul class="nav nav-tabs">
                        <li ng-class="{ active: isSet(1) }">
                            <a href ng-click="setTab(1)" translate> Config
                            </a>
                        </li>
                        <li ng-disabled="true" ng-if="editChartType != 'text'" ng-class="{ active: isSet(2) }">
                            <a ng-click="setTab(2)" translate> Filter
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="tab-content">
                    <div ng-show="isSet(1)">
                        <div class="row edit-widget">
                            <div ng-if="!(editChartType == 'table' || editChartType == 'text' || editChartType == '')">
                                <div class="col-lg-12 table-deeta edit-widget">
                                    <div class="hpanel hgreen border-table"> 
                                        <div class="panel-heading">
                                            <div class="edit-widget-space">
                                                <div ng-hide='editPreviewTitle'> 
                                                    <a class="title-ew" ng-click='editPreviewTitle = true;'>{{widget.widgetTitle?widget.widgetTitle:"Widget Title"}}</a>
                                                </div> 
                                                <div class="col-sm-10" ng-show='editPreviewTitle'>                           
                                                    <input  class='form-control' type='text' ng-model='widget.widgetTitle'>
                                                </div>
                                                <div class='col-sm-2 pull-right' ng-show='editPreviewTitle'>
                                                    <a ng-click='editPreviewTitle = false'><i class='fa fa-save'></i></a>
                                                    <a ng-click='editPreviewTitle = false'><i class='fa fa-close'></i></a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-body">                    

                                            <div class="col-md-6" ng-if="editChartType != 'ticker'">
                                                <div class="form-group">
                                                    <div class="col-md-12" ng-if="!(editChartType == 'pie' || editChartType == 'funnel')">
                                                        <label translate>Select X-Axis</label>
                                                        <select style="height:28px; font-size: 11px;  padding: 0px 12px;" 
                                                                class="form-control" ng-model="xColumn" 
                                                                ng-options="currentColumn.displayName for currentColumn in collectionFields track by currentColumn.fieldName" 
                                                                ng-change="selectX1Axis(widget, xColumn)">
                                                        </select>
                                                    </div>
                                                    <div class="col-md-12" ng-show="editChartType == 'pie'">
                                                        <label translate>Select X Axis</label>
                                                        <select style="height:28px; font-size: 11px;  padding: 0px 12px;" 
                                                                class="form-control" ng-model="selectPieChartXAxis" 
                                                                ng-options="currentColumn.displayName for currentColumn in collectionFields track by currentColumn.fieldName" 
                                                                ng-change="selectPieChartX(widget, selectPieChartXAxis)">
                                                        </select>
                                                    </div>
                                                    <div class="col-md-12" ng-show="editChartType == 'pie'">
                                                        <label translate>Select Y Axis</label>
                                                        <select style="height:28px; font-size: 11px;  padding: 0px 12px;" 
                                                                class="form-control" ng-model="selectPieChartYAxis" 
                                                                ng-options="currentColumn.displayName for currentColumn in collectionFields track by currentColumn.fieldName" 
                                                                ng-change="selectPieChartY(widget, selectPieChartYAxis)">
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="form-group" ng-if="!(editChartType == 'pie' || editChartType == 'funnel')">
                                                    <div class="col-md-12">
                                                        <label translate>Select Y1-Axis</label>
                                                        <ui-select multiple ng-model="y1Column" theme="bootstrap"  on-select="selectY1Axis(widget, y1Column)" on-remove="removedByY1Column(widget,$item, y1Column)">
                                                            <ui-select-match placeholder="{{'y1 Axis'| translate}}">{{$item.displayName}}</ui-select-match>
                                                            <ui-select-choices repeat="y1axis in collectionFields  | filter:$select.search">
                                                                {{y1axis.displayName}}
                                                            </ui-select-choices>
                                                        </ui-select>
                                                    </div>
                                                </div>

                                                <div class="form-group" ng-if="!(editChartType == 'pie' || editChartType == 'stackedbar' || editChartType == 'funnel')">
                                                    <div class="col-md-12">
                                                        <label translate>Select Y2-Axis</label>
                                                        <ui-select multiple ng-model="y2Column" theme="bootstrap" on-select="selectY2Axis(widget, y2Column)" on-remove="removedByY2Column(widget,$item, y2Column)">
                                                            <ui-select-match placeholder="{{'y2 Axis'| translate}}">{{$item.displayName}}</ui-select-match>
                                                            <ui-select-choices repeat="y2axis in collectionFields  | filter:$select.search">
                                                                {{y2axis.displayName}}
                                                            </ui-select-choices>
                                                        </ui-select>
                                                    </div>
                                                </div>

                                                <div class="form-group" ng-show="editChartType == 'funnel'">
                                                    <div class="col-md-12">
                                                        <label translate>Data</label>
                                                        <ui-select multiple ng-model="funnelItem"  theme="bootstrap" on-select="funnel(widget, funnelItem)" 
                                                                   on-remove="removedByFunnel(widget,$item,funnelItem)">
                                                            <ui-select-match placeholder="{{'Data'| translate}}">{{$item.displayName}}</ui-select-match>
                                                            <ui-select-choices repeat="funnelColumn in collectionFields  | filter:$select.search">
                                                                {{funnelColumn.displayName}}
                                                            </ui-select-choices>
                                                        </ui-select>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <div class="col-md-8">
                                                        <input type="checkbox" ng-model="showAdvanceOptions"> <span translate>Advance Options</span>
                                                    </div>
                                                    <div class="col-md-4" ng-if="editChartType != 'pie'">
                                                        <label translate>Grid Line</label>
                                                        <select class='form-control' style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='widget.isGridLine' ng-change="setGridLine(widget)">
                                                            <option ng-repeat=' grid in gridLine' value='{{grid.value}}'>{{grid.name}}</option>
                                                        </select> 
                                                    </div>
                                                </div>

                                                <div class="form-group" >
                                                    <div class="col-md-12" ng-if="showAdvanceOptions == true">
                                                        <label translate>Format</label>                                 
                                                        <table class="table table-bordered table-responsive">
                                                            <thead>
                                                                <tr>
                                                                    <th translate>Field Name</th>
                                                                    <th translate>Display Name</th>
                                                                    <th translate>Format</th>
                                                                    <th translate>Sort</th>
                                                                    <th translate>Field Type</th>
                                                                    <th ng-if="editChartType !== 'pie'" translate>Combination Type</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="columnList in widget.columns">
                                                                    <td>{{columnList.fieldName}}</td>
                                                                    <td>
                                                                        <div>
                                                                            <input type="text" class="form-control" ng-model="columnList.displayName">
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <select class='form-control' style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='columnList.displayFormat' ng-change="gridl(widget, columnList)">
                                                                            <option ng-repeat='format in formats' value='{{format.value}}'>{{format.name}}</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='columnList.sortOrder' ng-change="setChartFormat(widget, columnList)" class='form-control'>
                                                                            <option ng-repeat='sort in sorting' value='{{sort.value}}'>{{sort.name}}</option>
                                                                        </select>
                                                                    </td>
                                                                    <td>
                                                                        <select class='form-control' style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='columnList.fieldType' ng-change="setChartFormat(widget, columnList)">
                                                                            <option ng-repeat='fieldType in fieldTypes' value='{{fieldType.value}}'>{{fieldType.name}}</option>
                                                                        </select>
                                                                    </td>
                                                                    <td ng-if="editChartType !== 'pie'">
                                                                        <select class='form-control' style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='columnList.combinationType' ng-change="setCombinationChartType(widget, columnList)">
                                                                            <option ng-repeat=' combinationChartType in combinationChartTypes' value='{{combinationChartType.value}}'>{{combinationChartType.name}}</option>
                                                                        </select> 
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>

                                            </div>
                                            <div class="col-md-4" ng-show="editChartType == 'ticker'">
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label translate>Ticker Items</label>
                                                        <ui-select multiple ng-model="tickerItem" limit='3' theme="bootstrap" on-select="ticker(widget, tickerItem)" on-remove="removedByTicker(widget,$item,tickerItem)">
                                                            <ui-select-match placeholder="{{'Ticker Value'|translate}}">{{$item.displayName}}</ui-select-match>
                                                            <ui-select-choices repeat="currentColumn in collectionFields  | filter:$select.search">
                                                                {{currentColumn.displayName}}
                                                            </ui-select-choices>
                                                        </ui-select>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <div class="col-md-12">
                                                        <label translate>Format</label>
                                                        <table class="table table-bordered">
                                                            <thead>
                                                                <tr>
                                                                    <td translate>Field Name</td>
                                                                    <td translate>Display Name</td>
                                                                    <td translate>Format</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="tickerItems in widget.columns">
                                                                    <td>{{tickerItems.displayName}}</td>
                                                                    <td>
                                                                        <div>
                                                                            <input type="text" class="form-control" ng-model="tickerItems.displayName">
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <select class='form-control' style="height:28px; font-size: 11px;  padding: 0px 12px;" ng-model='tickerItems.displayFormat' ng-change="tickerFormat(widget, tickerItems)">
                                                                            <option ng-repeat='format in formats' value='{{format.value}}'>{{format.name}}</option>
                                                                        </select>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class="form-group" ng-if="editChartType != 'ticker'">
                                                    <div>
                                                        <label translate>Max Record</label>
                                                        <input type="text" ng-model="widget.maxRecord" class="form-control" ng-change="reloadMaxRecord(widget)">
                                                    </div>
                                                </div>
                                                <div ng-if="editChartType === 'ticker'">
                                                    <div ticker-Directive ticker-Source="{{previewChartUrl}}" widget-Obj="{{widget}}" ticker-Id="{{widget.id}}" ticker-Columns="{{previewColumn.columns}}"></div>
                                                </div>
                                                <div ng-if="editChartType === 'line'">
                                                    <div>
                                                        <div line-Chart-Source='{{previewChartUrl}}' widget-Id="{{widget.id}}" widget-Columns="{{previewColumn.columns}}" line-Chart-Directive preview-Widget="{{previewColumn}}" widget-Obj="{{widget}}"></div>
                                                    </div>
                                                </div>
                                                <div ng-if="editChartType === 'area'">
                                                    <div>
                                                        <div area-Chart-Source='{{previewChartUrl}}' widget-Id="{{widget.id}}" widget-Columns="{{previewColumn.columns}}" area-Chart-Directive preview-Widget="{{previewColumn}}" widget-Obj="{{widget}}"></div>
                                                    </div>
                                                </div>
                                                <div ng-if="editChartType === 'bar'">
                                                    <div>
                                                        <div bar-Chart-Directive bar-Chart-Source='{{previewChartUrl}}' widget-Id="{{widget.id}}" widget-Columns="{{previewColumn.columns}}" preview-Widget="{{previewColumn}}" widget-Obj="{{widget}}"></div>
                                                    </div>
                                                </div>
                                                <div ng-if="editChartType === 'pie'">
                                                    <div>
                                                        <div pie-Chart-Source='{{previewChartUrl}}' widget-Id="{{widget.id}}" widget-Columns="{{previewColumn.columns}}" pie-Chart-Directive preview-Widget="{{previewColumn}}" widget-Obj="{{widget}}"></div>
                                                    </div>                            
                                                </div> 
                                                <div ng-if="editChartType === 'stackedbar'">
                                                    <div>
                                                        <div stacked-Bar-Chart-Source='{{previewChartUrl}}' widget-Id="{{widget.id}}" widget-Columns="{{previewColumn.columns}}" stacked-Bar-Chart-Directive preview-Widget="{{previewColumn}}" widget-Obj="{{widget}}"></div>
                                                    </div>                            
                                                </div>
                                                <div ng-if="editChartType === 'funnel'">
                                                    <div>
                                                        <div funnel-Directive funnel-Source="{{previewChartUrl}}" funnel-Id="{{widget.id}}" funnel-Columns="{{previewColumn.columns}}"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div> 
                                        <div class='panel-footer'>
                                            <div>
                                                <button class='btn btn-default' ng-click='closeWidget()'><span class='fa fa-times'></span> <span translate>Cancel</span></button>
                                                <button class='btn btn-info' ng-click='save(widget)'><span class='fa fa-save'></span> <span translate>Save</span></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row edit-widget" ng-if="editChartType === 'table'">
                            <div class="col-lg-12">
                                <div class="preview-table">
                                    <div widget-Preview-Table 
                                         save-Query-Fn="saveQueryFn(savequeryFn)"
                                         preview-Table-List='{{collectionFields}}'
                                         preview-Urls='{{previewChartUrl}}' 
                                         preview-Columns='{{widget.columns}}' 
                                         preview-Widget="{{previewColumn}}" 
                                         preview-Widget-Table="{{widget}}"
                                         aggregations-Types="{{selectAggregations}}"
                                         group-Priorities="{{selectGroupPriorities}}"
                                         sorting-Fields="{{sorting}}"
                                         display-Formats="{{formats}}"
                                         display-Alignments="{{alignments}}"
                                         hide-Options="{{hideOptions}}"
                                         field-Types="{{fieldTypes}}"
                                         reload-Url="{{currentLocation}}"
                                         last-N-Days="{{widget.lastNdays}}"
                                         last-N-Weeks="{{widget.lastNweeks}}"
                                         last-N-Months="{{widget.lastNmonths}}"
                                         last-N-Years="{{widget.lastNyears}}">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-if="editChartType === 'text'">
                            <div class="col-sm-12">
                                <div class="hpanel hgreen border-table">
                                    <div class="panel-heading">
                                        <div ng-hide='editPreviewTitle'> 
                                            <span><a ng-click='editPreviewTitle = true'>{{widget.widgetTitle?widget.widgetTitle:"Widget Title"}}</a></span>
                                        </div> 
                                        <div ng-show='editPreviewTitle'>
                                            <div class='col-sm-8'>
                                                <input  class='form-control' type='text' ng-model='widget.widgetTitle'>
                                            </div> 
                                            <div class='col-sm-4'>
                                                <a ng-click='editPreviewTitle = false'><i class='fa fa-save'></i></a>
                                                <a ng-click='editPreviewTitle = false'><i class='fa fa-close'></i></a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel-body" style="overflow: auto;height:350px;">
                                        <div>
                                            <textarea ck-Editor ng-model="widget.content" rows="10" cols="99"></textarea>
                                        </div>  
                                    </div>  
                                    <div class='panel-footer'>
                                        <div>
                                            <button class='btn btn-default' ng-click='closeWidget()'><span class='fa fa-times'></span> <span translate>Cancel</span></button>
                                            <button class='btn btn-info' ng-click='save(widget)'><span class='fa fa-save'></span> <span translate>Save</span></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div ng-show="isSet(2) && editChartType != 'text'" class="license">
                        <div class="col-lg-12" ng-if="dispQueryBuilder == true">
                            <div jquery-Query-Builder query-Data="{{previewColumn}}"></div>
                            <div class='panel-footer'>
                                <div class="pull-right">

                                    <button id="btn-clear" class="btn btn-default reset" data-target="basic" translate>Clear</button>
                                    <button class="btn btn-success set-json" id="btn-reset" data-target="basic" translate>Reset</button>
                                    <!--<button id="btn-get" class="btn btn-primary parse-json" data-target="basic">see Rules</button>-->
                                </div>
                                <div>
                                    <!--<button class='btn btn-default' ng-click='saveQuery()'><span class='fa fa-arrow-left'></span> Back</button>-->
                                    <button class='btn btn-info' ng-click='saveQuery()' translate> Apply Filter</button>
                                    <!--<button class='btn btn-info' ng-click='widget.isQueryBuilder = true; save(widget)'> Apply Filter</button>-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
